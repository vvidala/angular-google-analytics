/**
 * Angular Google Analytics - Easy tracking for your AngularJS application
 * @version v1.1.8 - 2017-09-15
 * @link http://github.com/revolunet/angular-google-analytics
 * @author Julien Bouquillon <julien@revolunet.com> (https://github.com/revolunet)
 * @contributors Julien Bouquillon (https://github.com/revolunet),Justin Saunders (https://github.com/justinsa),Chris Esplin (https://github.com/deltaepsilon),Adam Misiorny (https://github.com/adam187)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */

!function(t,n){"use strict";"undefined"!=typeof module&&module.exports?(n("undefined"==typeof angular?require("angular"):angular),module.exports="angular-google-analytics"):"function"==typeof define&&define.amd?define(["angular"],n):n(t.angular)}(this,function(t,n){"use strict";return t.module("angular-google-analytics",[]).provider("Analytics",function(){var e,i,r,c,a,o=!0,s=!1,u=!1,l="USD",f=!1,d=!1,p=!1,m=!1,g=!1,h=!1,k=!1,_=!1,y=!1,E=!1,v=!1,b="$routeChangeSuccess",w=!1,T=!1,A=!1,D="",P=!0,x=!1;this.log=[],this.offlineQueue=[],this.setAccount=function(i){return e=t.isUndefined(i)||!1===i?n:t.isArray(i)?i:t.isObject(i)?[i]:[{tracker:i,trackEvent:!0}],this},this.trackPages=function(t){return P=!!t,this},this.trackPrefix=function(t){return D=t,this},this.setDomainName=function(t){return r=t,this},this.useDisplayFeatures=function(t){return p=!!t,this},this.useAnalytics=function(t){return o=!!t,this},this.useEnhancedLinkAttribution=function(t){return k=!!t,this},this.useCrossDomainLinker=function(t){return u=!!t,this},this.setCrossLinkDomains=function(t){return i=t,this},this.setPageEvent=function(t){return b=t,this},this.useECommerce=function(t,n){return g=!!t,h=!!n,this},this.setCurrency=function(t){return l=t,this},this.setRemoveRegExp=function(t){return t instanceof RegExp&&(a=t),this},this.setExperimentId=function(t){return c=t,this},this.ignoreFirstPageLoad=function(t){return _=!!t,this},this.trackUrlParams=function(t){return x=!!t,this},this.disableAnalytics=function(t){return m=!!t,this},this.setHybridMobileSupport=function(t){return E=!!t,this},this.startOffline=function(t){return!0===(v=!!t)&&this.delayScriptTag(!0),this},this.delayScriptTag=function(t){return d=!!t,this},this.logAllCalls=function(t){return y=!!t,this},this.enterTestMode=function(){return T=!0,this},this.enterDebugMode=function(t){return f=!0,A=!!t,this},this.readFromRoute=function(t){return w=!!t,this},this.$get=["$document","$location","$log","$rootScope","$window","$injector",function(L,j,C,I,S,q){var $=this,N=function(n,e){return t.isObject(e)&&t.isDefined(e[n])},F=function(t,n,e){return N(t,n)&&n[t]===e},O=function(n,e){return t.isString(e)?e+"."+n:N("name",e)?e.name+"."+n:n},M={};w&&(q.has("$route")?M=q.get("$route"):q.has("$state")?M=q.get("$state"):C.warn("routing service is not available. Make sure you have included ng-route or ui-route in your application dependencies."));var U=function(){if(w&&M.current&&"pageTrack"in M.current)return M.current.pageTrack;var t=x?j.url():j.path();return a?t.replace(a,""):t},R=function(){var n={utm_source:"campaignSource",utm_medium:"campaignMedium",utm_term:"campaignTerm",utm_content:"campaignContent",utm_campaign:"campaignName"},e={};return t.forEach(j.search(),function(i,r){var c=n[r];t.isDefined(c)&&(e[c]=i)}),e},Q=function(t,n,e,i,r,c,a,o,s){var u={};return t&&(u.id=t),n&&(u.affiliation=n),e&&(u.revenue=e),i&&(u.tax=i),r&&(u.shipping=r),c&&(u.coupon=c),a&&(u.list=a),o&&(u.step=o),s&&(u.option=s),u},B=function(t){return D+(t||U())},V=function(n,e){var i="",r="https:"===document.location.protocol,c="chrome-extension:"===document.location.protocol,a=!0===o&&!0===E;return n=t.isString(n)?n:"",e=t.isString(e)?e:"",""!==n&&(i="http:"+n),(c||a||r&&""!==e)&&(i="https:"+e),i},X=function(t){!o&&S._gaq&&"function"==typeof t&&t()},G=function(){var t=Array.prototype.slice.call(arguments);!0!==v?(S._gaq||(S._gaq=[]),!0===y&&$._log.apply($,t),S._gaq.push(t)):$.offlineQueue.push([G,t])},H=function(t){o&&S.ga&&"function"==typeof t&&t()},z=function(){var t=Array.prototype.slice.call(arguments);!0!==v?"function"==typeof S.ga?(!0===y&&$._log.apply($,t),S.ga.apply(null,t)):$._log("warn","ga function not set on window"):$.offlineQueue.push([z,t])},J=function(t){var n=Array.prototype.slice.call(arguments,1),i=n[0],r=[];"function"==typeof t?e.forEach(function(n){t(n)&&r.push(n)}):r=e,0!==r.length?r.forEach(function(t){N("select",t)&&"function"==typeof t.select&&!t.select(n)||(n[0]=O(i,t),z.apply($,n))}):z.apply($,n)};return this._log=function(){var t=Array.prototype.slice.call(arguments);if(t.length>0){if(t.length>1)switch(t[0]){case"debug":case"error":case"info":case"log":case"warn":C[t[0]](t.slice(1))}$.log.push(t)}},this._registerScriptTags=function(){var t,n=L[0],i=V();if(!0===s)return $._log("warn","Script tags already created"),!1;if(!0===m&&e.forEach(function(t){$._log("info","Analytics disabled: "+t.tracker),S["ga-disable-"+t.tracker]=!0}),!0===o){if(t=i+"//www.google-analytics.com/"+(f?"analytics_debug.js":"analytics.js"),!0!==T?function(t,n,e,i,r,c,a){t.GoogleAnalyticsObject=r,t[r]=t[r]||function(){(t[r].q=t[r].q||[]).push(arguments)},t[r].l=1*new Date,c=n.createElement(e),a=n.getElementsByTagName(e)[0],c.async=1,c.src=i,a.parentNode.insertBefore(c,a)}(window,n,"script",t,"ga"):("function"!=typeof S.ga&&(S.ga=function(){}),$._log("inject",t)),A&&(S.ga_debug={trace:!0}),c){var r=n.createElement("script"),a=n.getElementsByTagName("script")[0];r.src=i+"//www.google-analytics.com/cx/api.js?experiment="+c,a.parentNode.insertBefore(r,a)}}else t=V("//www","//ssl")+".google-analytics.com/ga.js",!0===p&&(t=i+"//stats.g.doubleclick.net/dc.js"),!0!==T?function(){var e=n.createElement("script");e.type="text/javascript",e.async=!0,e.src=t;var i=n.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i)}():$._log("inject",t);return s=!0,!0},this._registerTrackers=function(){return!e||e.length<1?($._log("warn","No accounts to register"),!1):(!0===o?e.forEach(function(n){n.crossDomainLinker=N("crossDomainLinker",n)?n.crossDomainLinker:u,n.crossLinkDomains=N("crossLinkDomains",n)?n.crossLinkDomains:i,n.displayFeatures=N("displayFeatures",n)?n.displayFeatures:p,n.enhancedLinkAttribution=N("enhancedLinkAttribution",n)?n.enhancedLinkAttribution:k,n.set=N("set",n)?n.set:{},n.trackEcommerce=N("trackEcommerce",n)?n.trackEcommerce:g,n.trackEvent=!!N("trackEvent",n)&&n.trackEvent;var e={};N("fields",n)&&(e=n.fields),!0===n.crossDomainLinker&&(e.allowLinker=!0),N("name",n)&&(e.name=n.name),n.fields=e,z("create",n.tracker,n.fields),!0===E&&z(O("set",n),"checkProtocolTask",null);for(var r in n.set)n.set.hasOwnProperty(r)&&z(O("set",n),r,n.set[r]);!0===n.crossDomainLinker&&(z(O("require",n),"linker"),t.isDefined(n.crossLinkDomains)&&z(O("linker:autoLink",n),n.crossLinkDomains)),n.displayFeatures&&z(O("require",n),"displayfeatures"),n.trackEcommerce&&(h?(z(O("require",n),"ec"),z(O("set",n),"&cu",l)):z(O("require",n),"ecommerce")),n.enhancedLinkAttribution&&z(O("require",n),"linkid"),P&&!_&&z(O("send",n),"pageview",B())}):(e.length>1&&($._log("warn","Multiple trackers are not supported with ga.js. Using first tracker only"),e=e.slice(0,1)),G("_setAccount",e[0].tracker),r&&G("_setDomainName",r),k&&G("_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"),P&&!_&&(a?G("_trackPageview",U()):G("_trackPageview"))),!0)},this._ecommerceEnabled=function(t,n){var e=g&&!h;return!0===t&&!1===e&&(g&&h?$._log("warn",n+" is not available when Enhanced Ecommerce is enabled with analytics.js"):$._log("warn","Ecommerce must be enabled to use "+n+" with analytics.js")),e},this._enhancedEcommerceEnabled=function(t,n){var e=g&&h;return!0===t&&!1===e&&$._log("warn","Enhanced Ecommerce must be enabled to use "+n+" with analytics.js"),e},this._trackPage=function(e,i,r){i=i||L[0].title,X(function(){G("_set","title",i),G("_trackPageview",B(e))}),H(function(){var c={page:B(e),title:i};t.extend(c,R()),t.isObject(r)&&t.extend(c,r),J(n,"send","pageview",c)})},this._trackEvent=function(n,e,i,r,c,a){X(function(){G("_trackEvent",n,e,i,r,!!c)}),H(function(){var o={};t.isDefined(c)&&(o.nonInteraction=!!c),t.isObject(a)&&t.extend(o,a),t.isDefined(o.page)||(o.page=B()),J(function(t){return F("trackEvent",t,!0)},"send","event",n,e,i,r,o)})},this._addTrans=function(t,n,e,i,r,c,a,o,s){X(function(){G("_addTrans",t,n,e,i,r,c,a,o)}),H(function(){if($._ecommerceEnabled(!0,"addTrans")){J(function(t){return F("trackEcommerce",t,!0)},"ecommerce:addTransaction",{id:t,affiliation:n,revenue:e,tax:i,shipping:r,currency:s||"USD"})}})},this._addItem=function(t,n,e,i,r,c){X(function(){G("_addItem",t,n,e,i,r,c)}),H(function(){if($._ecommerceEnabled(!0,"addItem")){J(function(t){return F("trackEcommerce",t,!0)},"ecommerce:addItem",{id:t,name:e,sku:n,category:i,price:r,quantity:c})}})},this._trackTrans=function(){X(function(){G("_trackTrans")}),H(function(){if($._ecommerceEnabled(!0,"trackTrans")){J(function(t){return F("trackEcommerce",t,!0)},"ecommerce:send")}})},this._clearTrans=function(){H(function(){if($._ecommerceEnabled(!0,"clearTrans")){J(function(t){return F("trackEcommerce",t,!0)},"ecommerce:clear")}})},this._addProduct=function(n,e,i,r,c,a,o,s,u,l){X(function(){G("_addProduct",n,e,i,r,c,a,o,s,u)}),H(function(){if($._enhancedEcommerceEnabled(!0,"addProduct")){var f={id:n,name:e,category:i,brand:r,variant:c,price:a,quantity:o,coupon:s,position:u};t.isObject(l)&&t.extend(f,l),J(function(t){return F("trackEcommerce",t,!0)},"ec:addProduct",f)}})},this._addImpression=function(t,n,e,i,r,c,a,o){X(function(){G("_addImpression",t,n,e,i,r,c,a,o)}),H(function(){if($._enhancedEcommerceEnabled(!0,"addImpression")){J(function(t){return F("trackEcommerce",t,!0)},"ec:addImpression",{id:t,name:n,category:r,brand:i,variant:c,list:e,position:a,price:o})}})},this._addPromo=function(t,n,e,i){X(function(){G("_addPromo",t,n,e,i)}),H(function(){if($._enhancedEcommerceEnabled(!0,"addPromo")){J(function(t){return F("trackEcommerce",t,!0)},"ec:addPromo",{id:t,name:n,creative:e,position:i})}})},this._setAction=function(t,n){X(function(){G("_setAction",t,n)}),H(function(){if($._enhancedEcommerceEnabled(!0,"setAction")){J(function(t){return F("trackEcommerce",t,!0)},"ec:setAction",t,n)}})},this._trackTransaction=function(t,n,e,i,r,c,a,o,s){this._setAction("purchase",Q(t,n,e,i,r,c,a,o,s))},this._trackRefund=function(t){this._setAction("refund",Q(t))},this._trackCheckOut=function(t,n){this._setAction("checkout",Q(null,null,null,null,null,null,null,t,n))},this._trackDetail=function(){this._setAction("detail"),this._pageView()},this._trackCart=function(t,n){-1!==["add","remove"].indexOf(t)&&(this._setAction(t,{list:n}),this._trackEvent("UX","click",t+("add"===t?" to cart":" from cart")))},this._promoClick=function(t){this._setAction("promo_click"),this._trackEvent("Internal Promotions","click",t)},this._productClick=function(t){this._setAction("click",Q(null,null,null,null,null,null,t,null,null)),this._trackEvent("UX","click",t)},this._pageView=function(t){H(function(){z(O("send",t),"pageview")})},this._send=function(){var t=Array.prototype.slice.call(arguments);t.unshift("send"),H(function(){z.apply($,t)})},this._set=function(t,n,e){H(function(){z(O("set",e),t,n)})},this._trackTimings=function(t,e,i,r){H(function(){J(n,"send","timing",t,e,i,r)})},this._trackException=function(t,e){H(function(){J(n,"send","exception",{exDescription:t,exFatal:!!e})})},d||(this._registerScriptTags(),this._registerTrackers()),P&&I.$on(b,function(){(!w||M.current&&(M.current.templateUrl||M.current.template)&&!M.current.doNotTrack)&&$._trackPage()}),{log:$.log,offlineQueue:$.offlineQueue,configuration:{accounts:e,universalAnalytics:o,crossDomainLinker:u,crossLinkDomains:i,currency:l,debugMode:f,delayScriptTag:d,disableAnalytics:m,displayFeatures:p,domainName:r,ecommerce:$._ecommerceEnabled(),enhancedEcommerce:$._enhancedEcommerceEnabled(),enhancedLinkAttribution:k,experimentId:c,hybridMobileSupport:E,ignoreFirstPageLoad:_,logAllCalls:y,pageEvent:b,readFromRoute:w,removeRegExp:a,testMode:T,traceDebuggingMode:A,trackPrefix:D,trackRoutes:P,trackUrlParams:x},getUrl:U,registerScriptTags:function(){return $._registerScriptTags()},registerTrackers:function(){return $._registerTrackers()},offline:function(t){if(!0===t&&!1===v&&(v=!0),!1===t&&!0===v)for(v=!1;$.offlineQueue.length>0;){var n=$.offlineQueue.shift();n[0].apply($,n[1])}return v},trackPage:function(t,n,e){$._trackPage.apply($,arguments)},trackEvent:function(t,n,e,i,r,c){$._trackEvent.apply($,arguments)},addTrans:function(t,n,e,i,r,c,a,o,s){$._addTrans.apply($,arguments)},addItem:function(t,n,e,i,r,c){$._addItem.apply($,arguments)},trackTrans:function(){$._trackTrans.apply($,arguments)},clearTrans:function(){$._clearTrans.apply($,arguments)},addProduct:function(t,n,e,i,r,c,a,o,s,u){$._addProduct.apply($,arguments)},addPromo:function(t,n,e,i){$._addPromo.apply($,arguments)},addImpression:function(t,n,e,i,r,c,a,o){$._addImpression.apply($,arguments)},productClick:function(t){$._productClick.apply($,arguments)},promoClick:function(t){$._promoClick.apply($,arguments)},trackDetail:function(){$._trackDetail.apply($,arguments)},trackCart:function(t,n){$._trackCart.apply($,arguments)},trackCheckout:function(t,n){$._trackCheckOut.apply($,arguments)},trackTimings:function(t,n,e,i){$._trackTimings.apply($,arguments)},trackTransaction:function(t,n,e,i,r,c,a,o,s){$._trackTransaction.apply($,arguments)},trackException:function(t,n){$._trackException.apply($,arguments)},setAction:function(t,n){$._setAction.apply($,arguments)},pageView:function(){$._pageView.apply($,arguments)},send:function(t){$._send.apply($,arguments)},set:function(t,n,e){$._set.apply($,arguments)}}}]}).directive("gaTrackEvent",["Analytics","$parse",function(t,n){return{restrict:"A",link:function(e,i,r){var c=n(r.gaTrackEvent);i.bind("click",function(){r.gaTrackEventIf&&!e.$eval(r.gaTrackEventIf)||c.length>1&&t.trackEvent.apply(t,c(e))})}}}]),t.module("angular-google-analytics")});